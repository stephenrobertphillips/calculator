<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Voltage Drop and Fuse Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f4f4f4;
    }
    .container {
      max-width: 800px;
      margin: auto;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .result {
      font-weight: bold;
    }
    .warning {
      color: orange;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Voltage Drop and Fuse Calculator</h2>
    <label>System Voltage (V): <input type="number" id="voltage" value="12" /></label><br /><br />
    <label>Load Wattage (W): <input type="number" id="wattage" value="120" /></label><br /><br />
    <label>Round-trip Cable Length (meters): <input type="number" id="length" value="10" /></label><br /><br />
    <label>Cross-sectional Area (mmÂ²): <input type="number" id="csa" value="4" /></label><br /><br />
    <label>Number of Parallel Cables: <input type="number" id="parallel" value="1" /></label><br /><br />
    <label>Conductor Resistance (Ohm/km): <input type="number" id="resistance" value="4.61" /></label><br /><br />

    <button onclick="calculate()">Calculate</button>

    <h3>Results:</h3>
    <div id="results"></div>
  </div>

  <script>
    function calculate() {
      const voltage = parseFloat(document.getElementById('voltage').value);
      const wattage = parseFloat(document.getElementById('wattage').value);
      const length = parseFloat(document.getElementById('length').value);
      const csa = parseFloat(document.getElementById('csa').value);
      const parallel = parseFloat(document.getElementById('parallel').value);
      const resistancePerKm = parseFloat(document.getElementById('resistance').value);

      const current = wattage / voltage;
      const resistance = (resistancePerKm / 1000) / (csa * parallel);
      const vDrop = current * resistance * length;
      const percentDrop = (vDrop / voltage) * 100;

      let vClass = '';
      if (percentDrop > 10) vClass = 'error';
      else if (percentDrop > 3) vClass = 'warning';

      let fuse;
      const roundedCurrent = Math.ceil(current);
      if (roundedCurrent <= 25) fuse = nearest([5, 10, 15, 20, 25], roundedCurrent) + 'A Blade';
      else if (roundedCurrent <= 180) fuse = nearest([30, 40, 50, 60, 80, 100, 125, 150, 175, 180], roundedCurrent) + 'A MIDI';
      else if (roundedCurrent <= 600) fuse = nearest([200, 250, 300, 350, 400, 500, 600], roundedCurrent) + 'A MEGA';
      else fuse = '>600A Type 3';

      document.getElementById('results').innerHTML = `
        Load Current: <strong>${current.toFixed(2)} A</strong><br />
